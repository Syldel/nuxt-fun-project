import{f as J,S as ve,q as ie,r as K,T as Se,K as ue,o as I,c as M,U as ze,V as we,a as Ae,W as ne,l as V,J as _e,v as Ee,X as Be,w as Le,b as Ce}from"./entry.69fe7d3b.js";const Ie="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#$%*+,-.:;=?@[]^_{|}~",W=(e,t,s)=>{let r=0;for(;t<s;)r*=83,r+=Ie.indexOf(e[t++]);return r},de=Math.pow,$=Math.PI,xe=$*2,fe=3294.6,he=269.025,Te=e=>e>10.31475?de(e/he+.052132,2.4):e/fe,X=e=>~~(e>1227e-8?he*de(e,.416666)-13.025:e*fe+1),q=e=>(e<0?-1:1)*e*e,le=e=>{for(e+=$/2;e>$;)e-=xe;const t=1.27323954*e-.405284735*q(e);return .225*(q(t)-t)+t};function Ue(e){const t=W(e,2,6);return[t>>16,t>>8&255,t&255]}function He(e,t,s,r){const n=W(e,0,1),a=n%9+1,c=~~(n/9)+1,l=a*c;let o=0,p=0,f=0,d=0,i=0,y=0,x=0,z=0,B=0,m=0,w=0,k=0,N=0,A=0;const S=(W(e,1,2)+1)/13446*(r|1),b=new Float64Array(l*3),G=Ue(e);for(o=0;o<3;o++)b[o]=Te(G[o]);for(o=1;o<l;o++)A=W(e,4+o*2,6+o*2),b[o*3]=q(~~(A/(19*19))-9)*S,b[o*3+1]=q(~~(A/19)%19-9)*S,b[o*3+2]=q(A%19-9)*S;const R=t*4,_=new Uint8ClampedArray(R*s);for(d=0;d<s;d++)for(k=$*d/s,f=0;f<t;f++){for(i=0,y=0,x=0,N=$*f/t,p=0;p<c;p++)for(B=le(k*p),o=0;o<a;o++)z=le(N*o)*B,m=(o+p*a)*3,i+=b[m]*z,y+=b[m+1]*z,x+=b[m+2]*z;w=4*f+d*R,_[w]=X(i),_[w+1]=X(y),_[w+2]=X(x),_[w+3]=255}return _}const pe=typeof window>"u",Pe=!pe&&"loading"in HTMLImageElement.prototype,Me=!pe&&(!("onscroll"in window)||/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent));function qe(e,t=document){return typeof e=="string"?[...t.querySelectorAll(e)]:e instanceof Element?[e]:[...e]}function $e(e,t){let s,r;return e>=1?(s=t,r=Math.round(t/e)):(s=Math.round(t*e),r=t),{width:s,height:r}}function ke(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),s=typeof Buffer<"u"?Buffer.from(t,"base64"):Uint8Array.from(atob(t),r=>r.charCodeAt(0));return new Uint8Array(s)}/**
 * Encodes an RGBA image to a PNG data URI. RGB should not be premultiplied by A.
 *
 * @remarks
 * This is optimized for speed and simplicity and does not optimize for size
 * at all. This doesn't do any compression (all values are stored uncompressed).
 *
 * @see https://github.com/evanw/thumbhash
 * @author Evan Wallace
 * @license MIT
 */function ye(e,t,s){const r=e*4+1,n=6+t*(5+r),a=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,0,0,e>>8,e&255,0,0,t>>8,t&255,8,6,0,0,0,0,0,0,0,n>>>24,n>>16&255,n>>8&255,n&255,73,68,65,84,120,1],c=[0,498536548,997073096,651767980,1994146192,1802195444,1303535960,1342533948,-306674912,-267414716,-690576408,-882789492,-1687895376,-2032938284,-1609899400,-1111625188];let l=1,o=0;for(let f=0,d=0,i=r-1;f<t;f++,i+=r-1)for(a.push(f+1<t?0:1,r&255,r>>8,~r&255,r>>8^255,0),o=(o+l)%65521;d<i;d++){const y=s[d]&255;a.push(y),l=(l+y)%65521,o=(o+l)%65521}a.push(o>>8,o&255,l>>8,l&255,0,0,0,0,0,0,0,0,73,69,78,68,174,66,96,130);for(let[f,d]of[[12,29],[37,41+n]]){let i=-1;for(let y=f;y<d;y++)i^=a[y],i=i>>>4^c[i&15],i=i>>>4^c[i&15];i=~i,a[d++]=i>>>24,a[d++]=i>>16&255,a[d++]=i>>8&255,a[d++]=i&255}return`data:image/png;base64,${typeof Buffer<"u"?Buffer.from(new Uint8Array(a)).toString("base64"):btoa(String.fromCharCode(...a))}`}const Z=32;function Ne(e,{ratio:t=1,size:s=Z}={}){const{width:r,height:n}=$e(t,s),a=He(e,r,n);return ye(r,n,a)}function Re(e){let{PI:t,min:s,max:r,cos:n,round:a}=Math,c=e[0]|e[1]<<8|e[2]<<16,l=e[3]|e[4]<<8,o=(c&63)/63,p=(c>>6&63)/31.5-1,f=(c>>12&63)/31.5-1,d=(c>>18&31)/31,i=c>>23,y=(l>>3&63)/63,x=(l>>9&63)/63,z=l>>15,B=r(3,z?i?5:7:l&7),m=r(3,z?l&7:i?5:7),w=i?(e[5]&15)/15:1,k=(e[5]>>4)/15,N=i?6:5,A=0,S=(U,v,H)=>{let L=[];for(let E=0;E<v;E++)for(let C=E?0:1;C*v<U*(v-E);C++)L.push(((e[N+(A>>1)]>>((A++&1)<<2)&15)/7.5-1)*H);return L},b=S(B,m,d),G=S(3,3,y*1.25),R=S(3,3,x*1.25),_=i&&S(5,5,k),j=je(e),D=a(j>1?32:32*j),O=a(j>1?32/j:32),T=new Uint8Array(D*O*4),F=[],Q=[];for(let U=0,v=0;U<O;U++)for(let H=0;H<D;H++,v+=4){let L=o,E=p,C=f,re=w;for(let u=0,h=r(B,i?5:3);u<h;u++)F[u]=n(t/D*(H+.5)*u);for(let u=0,h=r(m,i?5:3);u<h;u++)Q[u]=n(t/O*(U+.5)*u);for(let u=0,h=0;u<m;u++)for(let g=u?0:1,P=Q[u]*2;g*m<B*(m-u);g++,h++)L+=b[h]*F[g]*P;for(let u=0,h=0;u<3;u++)for(let g=u?0:1,P=Q[u]*2;g<3-u;g++,h++){let oe=F[g]*P;E+=G[h]*oe,C+=R[h]*oe}if(i)for(let u=0,h=0;u<5;u++)for(let g=u?0:1,P=Q[u]*2;g<5-u;g++,h++)re+=_[h]*F[g]*P;let ae=L-2/3*E,se=(3*L-ae+C)/2,be=se-C;T[v]=r(0,255*s(1,se)),T[v+1]=r(0,255*s(1,be)),T[v+2]=r(0,255*s(1,ae)),T[v+3]=r(0,255*s(1,re))}return{w:D,h:O,rgba:T}}function je(e){let t=e[3],s=e[2]&128,r=e[4]&128,n=r?s?5:7:t&7,a=r?t&7:s?5:7;return n/a}function De(e){const{w:t,h:s,rgba:r}=Re(ke(e));return ye(t,s,r)}function Oe(e='img[loading="lazy"]',{hash:t=!0,hashType:s="blurhash",placeholderSize:r=Z,onImageLoad:n}={}){var c;const a=new Set;for(const l of qe(e)){if(ce(l),((c=l.parentElement)==null?void 0:c.tagName.toLowerCase())==="picture"&&[...l.parentElement.getElementsByTagName("source")].forEach(ce),t){const p=ge({image:l,hash:typeof t=="string"?t:void 0,hashType:s,size:r});p&&(l.src=p)}if(!l.dataset.src&&!l.dataset.srcset)continue;if(Me||!Pe){me(l),te(l),ee(l);continue}if(l.complete&&l.naturalWidth>0){Y(l,n);continue}const o=()=>Y(l,n);l.addEventListener("load",o,{once:!0}),a.add(()=>l.removeEventListener("load",o))}return()=>{for(const l of a)l();a.clear()}}function Y(e,t){const s=new Image,{srcset:r,src:n,sizes:a}=e.dataset;r&&(s.srcset=r),n&&(s.src=n),a&&(s.sizes=a),s.addEventListener("load",()=>{me(e),te(e),ee(e),t==null||t(e)})}function ge({image:e,hash:t,hashType:s="blurhash",size:r=Z,ratio:n}={}){if(!t&&e){const{blurhash:a,thumbhash:c}=e.dataset;t=c||a,s=c?"thumbhash":"blurhash"}if(t)try{if(s==="thumbhash")return De(t);if(!n&&e){const a=e.width||e.offsetWidth||r,c=e.height||e.offsetHeight||r;n=a/c}return Ne(t,{ratio:n,size:r})}catch(a){console.error(`Error generating ${s} placeholder:`,a)}}function ce(e){var r,n;const{sizes:t}=e.dataset;if(t!=="auto")return;const s=e instanceof HTMLSourceElement?(n=(r=e.parentElement)==null?void 0:r.getElementsByTagName("img")[0])==null?void 0:n.offsetWidth:e.offsetWidth;s&&(e.sizes=`${s}px`)}function ee(e){e.dataset.src&&(e.src=e.dataset.src,e.removeAttribute("data-src"))}function te(e){e.dataset.srcset&&(e.srcset=e.dataset.srcset,e.removeAttribute("data-srcset"))}function me(e){const t=e.parentElement;(t==null?void 0:t.tagName.toLowerCase())==="picture"&&([...t.querySelectorAll("source[data-srcset]")].forEach(te),[...t.querySelectorAll("source[data-src]")].forEach(ee))}const Fe={key:0},Qe=["type","data-srcset","data-sizes"],We=["src","data-src","data-srcset","data-sizes"],Ve=["src","data-src","data-srcset","data-sizes"],Ge=J({inheritAttrs:!1,__name:"UnLazyImage",props:{src:{default:void 0},srcSet:{default:void 0},sources:{default:void 0},autoSizes:{type:Boolean,default:!1},blurhash:{default:void 0},thumbhash:{default:void 0},placeholderSrc:{default:void 0},placeholderSize:{default:void 0},placeholderRatio:{default:void 0},lazyLoad:{type:Boolean,default:!0},preload:{type:Boolean,default:!1},ssr:{type:Boolean,default:void 0}},setup(e){const t=e,{unlazy:s}=ve().public,r=ie(()=>t.thumbhash||t.blurhash),n=void 0,a=K();let c,l;return Se(()=>{if(c==null||c(),!!a.value){if(r.value&&r.value!==l){const o=ge({image:a.value,hash:r.value,hashType:t.thumbhash?"thumbhash":"blurhash",size:t.placeholderSize||s.placeholderSize,ratio:t.placeholderRatio});o&&(a.value.src=o),l=r.value}if(t.preload){Y(a.value);return}t.lazyLoad&&(c=Oe(a.value,{hash:!1}))}}),ue(()=>{c==null||c()}),(o,p)=>{var f;return(f=t.sources)!=null&&f.length?(I(),M("picture",Fe,[(I(!0),M(ze,null,we(t.sources,(d,i)=>(I(),M("source",{key:i,type:d.type,"data-srcset":d.srcSet,"data-sizes":d.sizes},null,8,Qe))),128)),Ae("img",ne({ref_key:"target",ref:a},o.$attrs,{src:V(n)||o.placeholderSrc,"data-src":o.src,"data-srcset":o.srcSet,"data-sizes":o.autoSizes?"auto":void 0,loading:"lazy"}),null,16,We)])):(I(),M("img",ne({key:1,ref_key:"target",ref:a},o.$attrs,{src:V(n)||o.placeholderSrc,"data-src":o.src,"data-srcset":o.srcSet,"data-sizes":o.autoSizes?"auto":void 0,loading:"lazy"}),null,16,Ve))}}}),Xe=J({__name:"AppIntersectionObserver",props:{root:{type:typeof HTMLElement<"u"?HTMLElement:Object,default:null},rootMargin:{type:String,default:"0px"},threshold:{type:Array,default:()=>[0,.2]}},emits:["change"],setup(e,{emit:t}){const s=e,r=K();let n;return _e(()=>{n=new IntersectionObserver(a=>{t("change",a[0])},s),n.observe(r.value)}),ue(()=>{n&&n.unobserve(r.value)}),(a,c)=>(I(),M("div",{ref_key:"target",ref:r},[Ee(a.$slots,"default")],512))}}),Je=J({__name:"BlurHashLazyImage",props:{src:{type:String,default:""},srcSet:{type:String,default:""},autoSizes:{type:Boolean,default:!1},blurhash:{type:String,default:"L0NdO8?bfQ?b~qj[fQj[fQfQfQfQ"},width:{type:Number},height:{type:Number},alt:{type:String,default:""},enableLazy:{type:Boolean,default:!0}},setup(e){const t=e,s=K(!1);function r(a){s.value=a.isIntersecting}const n=ie(()=>{let a="";if(t.alt)a=t.alt.trim().toLowerCase();else{const c=/([^\/]+?)(\.|\?\w+)[^\/]*$/gi.exec(t.src);c&&c.length>1&&(a=c[1].replace(/[_]+/gi," ").replace(/[-]+/gi," "))}return a});return(a,c)=>{const l=Ge,o=Xe;return I(),Be(o,{onChange:r},{default:Le(()=>[Ce(l,{blurhash:e.blurhash,src:e.src,"src-set":e.srcSet,"auto-sizes":e.autoSizes,width:e.width,height:e.height,alt:V(n),"lazy-load":e.enableLazy?V(s):!0},null,8,["blurhash","src","src-set","auto-sizes","width","height","alt","lazy-load"])]),_:1})}}});export{Ge as _,Je as a};
